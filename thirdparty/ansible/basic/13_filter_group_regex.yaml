- name: "Playbook for fruits csv"
  hosts: localhost
  gather_facts: no
  vars:
    input_regex: "^veg$"
  tasks:
    - read_csv:
        path: "configs/13_fruits.csv"
      register: fruits_csv_list
    - read_csv:
        path: "configs/13_fruits.csv"
        key: id
      register: fruits_csv_dict
    # - name: "Create a new list with combined fields"
    #   debug:
    #     msg: "{{jinja_list}}"
      # vars:
      #   - jinja_list: |-
      #       {% set ml = [] %}
      #       {% for item in fruits_csv_list.list %}
      #       {% set li = item.type + '-' +  item.name + '-' +  item.id %}
      #       {{ml.append(li)}}
      #       {%- endfor %}
      #       {{ml}}  

# https://serverfault.com/questions/685673/appending-to-lists-or-adding-keys-to-dictionaries-in-ansible
    - name: "Create a new list with combined fields"
      debug:
        msg: "{{ fruits_csv_list.list |combine({'country': 'US'}) }}"