{
    "from": "{{ rule.from }}",
    "to": "{{ rule.to }}",
    "interval": "{{ rule.interval }}",
    "query": {{ rule.query | tojson }},
    "actions": [
        {
            "group": "{{ action_config.group }}",
            "id": "{{ action_config.action_id }}",
            "params": {
                "documents": [
                    {
                        "rule.id": "{{{{rule.id}}}}",
                        "rule.rule_id": "{{{{rule.rule_id}}}}",
                        "rule.params.riskScore": "{{{{rule.params.riskScore}}}}",
                        "rule.params.severity": "{{{{rule.params.severity}}}}",
                        "rule.params.from": "{{{{rule.params.from}}}}",
                        "rule.params.to": "{{{{rule.params.to}}}}",
                        "rule.name": "{{{{rule.name}}}}",
                        "@timestamp": "{{{{date}}}}",
                        "context.results_link": "{{{{context.results_link}}}}",
                        "agg": "{{{{#ParseHjson}}}}[ {{{{#context.alerts}}}}{{{{ag}}}},{{{{/context.alerts}}}} ]{{{{/ParseHjson}}}}",
                        "uc_id": "{{ meta.uc_id }}",
                        "uc_type": "{{ meta.uc_type }}",
                        "uc_status": "{{ meta.uc_status }}",
                        "uc_short_name": "{{ meta.uc_short_name }}",
                        "uc_long_name": "{{ meta.uc_long_name }}",
                        "uc_severity": "{{ meta.uc_severity }}",
                        "uc_tags": "{{ meta.uc_tags }}",
                        "uc_tactic_id": "{{ meta.uc_mitre_tactic_id }}",
                        "uc_technique_ids": "{{ meta.uc_mitre_technique_ids }}"
                    }
                ]
            },
            "action_type_id": "{{ action_config.action_type_id }}"
        }
    ],
    "rule_id": "{{ meta.uc_id }}",
    "description": "{{ meta.uc_long_name }}",
    "enabled": {{ rule_defaults.enabled | lower }},
    "false_positives": {{ rule_defaults.false_positives | tojson }},
    "language": "{{ rule.language }}",
    "type": "{{ rule.language }}",
    "max_signals": {{ rule_defaults.max_signals }},
    "name": "{{ meta.uc_id }} - {{ meta.uc_short_name }}",
    "references": ["{{ reference_url }}"],
    "risk_score": "{{{{context.risk_score}}}}",
    "risk_score_mapping": [
        {
            "field": "user.name",
            "operator": "equals",
            "value": "",
            "risk_score": {{ base_risk_score }}
        }
    ],
    "severity": "{{ severity_string }}",
    "tags": {{ parsed_tags | tojson }},
    "threat": [
        {
            "framework": "{{ mitre.framework }}",
            "tactic": {
                "id": "{{ meta.uc_mitre_tactic_id }}",
                "name": "{{ meta.uc_mitre_tactic_id }}",
                "reference": "{{ mitre.base_tactic_url }}/{{ meta.uc_mitre_tactic_id }}"
            },
            "technique": [
                {% for technique_id in technique_ids %}
                {
                    "id": "{{ technique_id }}",
                    "name": "{{ technique_id }}",
                    "reference": "{{ mitre.base_technique_url }}/{{ technique_id }}"
                }{% if not loop.last %},{% endif %}
                {% endfor %}
            ]
        }
    ]
}